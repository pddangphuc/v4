==
<?php
function onStart()
{
    $this["myVar"] = "<div>
        <div class='info-popup'>
            <b>Additional Fees</b>
            <br />
             This property charges additional fees that will be added to the nightly rate total once you select your room type (if applicable).  
            <br />
            <span>Fees: $600 Cleaning Fee, $114 Accidental Damage Levy, 1.5% Visa/Mastercard & Amex   </span>
            <br />
            <b>Refundable Security Bond</b> 
            <br />
            This property charges a refundable security bond. The bond is separate from the nightly rate and is paid directly to the property owner prior to check-in. Payment details will be provided by the host after confirmation.  
            <br />
            <span>Bond amount: $2,000  </span>
            <br />
            <b>Price Guarantee</b>
            <br />
             We always offer the best available prices. If you find a better price that includes all applicable fees, let us know and we’ll match it!
        </div>
    </div>";



    //print_r($properties);
    //print_r($this['properties']);
}
?>
==
<div style="display: none;">
    <p>results:</p>
 {% set listProperties = properties %}

 <ul>
 {% for property in listProperties %}
    <li>{{ property.name }}</li>
 {% endfor %}
</ul>
</div>



{# Let's check that the list of products is not empty #}
{% if listProperties is not empty %}
        
    {# Render product list #}
    {% for property in listProperties %}
 
            <div class="col-xs-12 col-sm-4 col-md-6 col-lg-6">
                <div class="card card-height-landing" >
                   
                   {# Gallery part #}
                   {% partial 'site/search-gallery-block' propid=property.property_id %}
                    
                    
                    <div class="card-body" data-id="{{ property.property_id }}">
                        {# get details #}
                    
                        {% set beds = "text" %}
                        {% set guest = "text" %}
                        {% set region = "text" %}
                        {% set state = "text" %}
                        {% set country = "text" %}
                        {% set minaverage = "text" %}
                        {% set addfees = "text" %}
                        {% set addfeesnotes = "text" %}
                        {% set bond = "text" %}
                        {% set bondnotes = "text" %}
                        {% set propertytype = "text" %}
                          
                     
                       <div class="clearfix">
                           <div class="info-left">
                               <p class="landing_name">{{ property.name }}</p>
                              <!--     <a class="landing_address" data-toggle="modal" data-target="#popupMap" href="#">{{ region }}, {{ state }}, {{ country }}</a> -->
                                <p class="landing_address">{{ property.city }}, {{ property.state }}, {{ property.country_name }}</p>
                                <p></p>
                                <!-- <p class="landing_content">{{ obProduct.preview_text|length > 110 ? obProduct.preview_text|slice(0, 110) ~ '...' : obProduct.preview_text  }}</p> -->
                           </div>
                            <div class="info-right pull-right text-right">
                                {% if property.overall > 0 %}
                                <div class="rate-count"><span>{{property.ratings}}</span>/5 </div>
                                

                                <div class="rate-star">
                                  
                                    {% if property.ratings >= 1.0 and property.ratings <= 1.3 %}
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        {% for i in 1..4 %}
                                             <span class="item-star"><img src="{{ 'assets/images/star.png'|theme }}"></span>
                                        {% endfor %}
                                    {% elseif property.ratings >= 1.4 and property.ratings <= 1.8 %}
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-half.png'|theme }}"></span>
                                        {% for i in 1..3 %}
                                             <span class="item-star"><img src="{{ 'assets/images/star.png'|theme }}"></span>
                                        {% endfor %}
                                    {% elseif property.ratings >= 1.9 and property.ratings <= 2.3 %}
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        {% for i in 1..3 %}
                                             <span class="item-star"><img src="{{ 'assets/images/star.png'|theme }}"></span>
                                        {% endfor %}
                                    {% elseif property.ratings >= 2.4 and property.ratings <= 2.8 %}
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-half.png'|theme }}"></span>
                                        {% for i in 1..2 %}
                                             <span class="item-star"><img src="{{ 'assets/images/star.png'|theme }}"></span>
                                        {% endfor %}
                                    {% elseif property.ratings >= 2.9 and property.ratings <= 3.3 %}
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        {% for i in 1..2 %}
                                             <span class="item-star"><img src="{{ 'assets/images/star.png'|theme }}"></span>
                                        {% endfor %}
                                    {% elseif property.ratings >= 3.4 and property.ratings <= 3.8 %}
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-half.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star.png'|theme }}"></span>
                                        
                                    {% elseif property.ratings >= 3.9 and property.ratings <= 4.3 %}
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star.png'|theme }}"></span>

                                    {% elseif property.ratings >= 4.4 and property.ratings <= 4.8 %}
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-half.png'|theme }}"></span>
                                        

                                    {% elseif property.ratings >= 4.9 and property.ratings <= 5.0 %}
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>
                                        <span class="item-star"><img src="{{ 'assets/images/star-active.png'|theme }}"></span>

                                    {% endif %}


                                </div>
                                
                                    {% if property.ratings > 4.6 and property.ratings < 5.1 %}
                                        <p>Exceptional</p>
                                    {% elseif property.ratings > 4.4 and property.ratings < 4.7 %}
                                        <p>Wonderful</p>
                                    {% elseif property.ratings > 4.2 and property.ratings < 4.5 %}
                                        <p>Excellent</p>
                                    {% elseif property.ratings > 4.1 and property.ratings < 4.3 %}
                                        <p>Very Good</p>
                                    {% else %}
                                        <p>Good</p>
                                    {% endif %}
                                
                                
                                <span class="count-review">({{property.reviews}} reviews)</span>
                                {% else %}
                                <div class="rate-count" style="visibility: hidden;">No ratings</div>
                                <div class="rate-star" style="visibility: hidden;"></div>
                                <p style="visibility: hidden;">No rating</p>
                                {% endif %}

                            </div>
                       </div>
                       
                        <div class="ladding-info">
                          <div class="pull-left">
                             <ul class="list-landing">
                                <li><span><img src="{{ 'assets/images/check-green.png'|theme }}" alt=""></span>Free cancellation</li>
                                 <li><span><img src="{{ 'assets/images/check-green.png'|theme }}" alt=""></span>Free cancellation</li>
                                  <li><span><img src="{{ 'assets/images/check-green.png'|theme }}" alt=""></span>Free cancellation</li>
                            </ul>
                          </div>
                            <div class="text-right">
    					  	    <!-- div price  -->
                                {% if dateString is not empty %}
    					  	    <div class="lang_price">
    					  	        <p>for 1 night</p>
    					  	        
    					  	         <p class="landing_cost"><span class="info" data-toggle="popover" data-content="{% partial 'site/info' fees=addfees feesnotes=addfeesnotes bonds=bond bondsnotes=bondnotes%}"><img src="{{ 'assets/images/info.png'|theme }}"  class="btn-popup" /> </span><span class="price-cost">AU$2,600 </span> <span class="price">AUD ${{ minaverage|number_format }}</span> </p>
    					  	          <span class="landing_deposit"><a href="#" class="price-details">Price Details </a></span>
    					  	    </div>
                                {% else %}

                                <!-- div button  -->
                                <div class="clearfix">
                                    <button class="btn">Enter dates</button>
                                </div>
                                <!-- div Choose another date  -->
                                <!-- <div class="clearfix">
                                    <p>Choose another date</p>
                                    <p class="landing_cost">Unavailable</p>
                                </div> -->
                                {% endif %}
                            </div>
                        </div>
                            
                    </div>
                    
                 </div>
            </div>

    {% endfor %}

{% endif %}
<div class="modal fade room-popup" id="mapSearch" tabindex="-1" role="dialog" aria-labelledby="RefineSearchModalCenterTitle" aria-hidden="true">
        {% partial 'popup/popup-map-search' %}
</div>
<script>
 
function myMap() {
    var uluru = {lat: 1.28193, lng: 103.861598};
    var mapProp= {
      center: {lat: 1.282392, lng: 103.861592},
      zoom:17,
    };

    var map1 = new google.maps.Map(document.getElementById("googleMap"),mapProp);

   var image = 'https://app.viewretreats.net/themes/view-retreats/assets/images/search-popup-search.png';
 
  var marker1 = new google.maps.Marker({
    position: uluru,
    map: map1,
    icon: image,
    title: 'Uluru (Ayers Rock)'
  });
  
  var map = new google.maps.Map(
      document.getElementById('map-popup'), {zoom: 17, center: uluru});
  // The marker, positioned at Uluru
  var marker = new google.maps.Marker({position: uluru, map: map, icon: image});

}


</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAZpADMQa8FywO16leHeiX1Jwx4-7McbMQ&callback=myMap"></script>