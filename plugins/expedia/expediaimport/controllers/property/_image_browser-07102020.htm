<?php  // $this->relationRender('poster') ?>


<?= Form::open() ?>

    

    <?php 
    //$property_id  = Input::get('Property.property_id');
    //$property_id = '560677';
    //$property_name  = $this->vars['property_name'];

    // value that has been pass parameter to partial 
    //print_r($property_name);
    ?>
  
    <input type="hidden" name="property_id" value="<?= $property_id ?>" />
    <input type="hidden" name="property_name" value="<?= $property_name ?>" />
    <input type="hidden" name="property_slug" value="<?= $property_slug ?>" />


    <div class="modal-header">
        <button type="button" class="close" data-dismiss="popup">&times;</button>
        <h4 class="modal-title">Select Images for <?=  $property_name ?></h4>
    </div>

    <div class="modal-body">
        <!-- <? $itemFormWidget->render() ?> -->

         <?php

		    $imgQuery = Db::select( "SELECT id, property_id, links_large, poster FROM expedia_expediaimport_images WHERE property_id = $property_id");
		  ?>
			
		  <div style="display: flex;flex-wrap: wrap;">
		  		<!-- <div class="img_box">
		        	<img src="<?// $value->links_large ?>" />
		        </div> -->
		 
		 </div>

     <?php if(!empty($imgQuery)):?>

		 <div style="display: flex; flex-wrap: wrap;">

		 	 <?php foreach($imgQuery as $value): ?>
		        

		        <div class="img_box">
			        <div class="custom-control custom-checkbox image-checkbox">
			            <input type="checkbox" class="custom-control-input" name="selected_images[]" value="<?= $value->id ?>" id="ck_<?= $value->id ?>">
			            <label class="custom-control-label" for="ck_<?= $value->id ?>">
			                <img src="<?= $value->links_large ?>" alt="#" class="img-fluid">
			            </label>
			        </div>
			    </div>

           <?php if($value->poster == 1): ?>
              <script type="text/javascript">
                console.log('<?php echo $value->id;?>');
                $('#ck_'+ <?php echo $value->id;?>).trigger("click");
              </script>  

            <?php endif;?> 

            
		  	<?php endforeach; ?>
		</div>

    <?php else: ?>

      <p>No images saved on the property yet. Please click "Update Images" button to import images from Expedia</p>

    <?php endif;?>

	    
    </div>

    <div class="modal-footer">
        <button
            type="submit"
            data-request="onCreateItem"
            data-request-data="redirect:0"
            data-hotkey="ctrl+s, cmd+s"
            data-popup-load-indicator
            class="btn btn-primary">
            Save
        </button>

        <button
            type="button"
            class="btn btn-default"
            data-dismiss="popup">
            Cancel
        </button>
    </div>

<?= Form::close() ?>


<style>
.img_box {
	/*border:1px solid #ccc;
	*/
	max-width: 302px;

	
}

.img_box img {
	
}



/*!
 * Bootstrap Image Checkbox v0.1.0 (https://iqbalfn.github.io/bootstrap-image-checkbox/)
 * Copyright 2019 Iqbal Fauzi
 * Licensed under MIT (https://github.com/iqbalfnn/bootstrap-image-checkbox/blob/master/LICENSE)
 */

 .custom-control img {
 	max-width: 300px;
 }
.custom-control.image-checkbox {
  position: relative;
  padding-left: 0;
}

.custom-control.image-checkbox .custom-control-input:checked ~ .custom-control-label:after, .custom-control.image-checkbox .custom-control-input:checked ~ .custom-control-label:before {
  opacity: 1;
}

.custom-control.image-checkbox label {
  cursor: pointer;
  position: unset !important;
}

.custom-control.image-checkbox label:before {
  border-color: #007bff;
  background-color: #007bff;
}

.custom-control.image-checkbox label:after, .custom-control.image-checkbox label:before {
  transition: opacity .3s ease;
  opacity: 0;
  left: .25rem;
}

.custom-control.image-checkbox label:focus, .custom-control.image-checkbox label:hover {
  opacity: .8;
}

.custom-control.image-checkbox label img {
  border-radius: 2.5px;
}

.form-group-image-checkbox.is-invalid label {
  color: #dc3545;
}

.form-group-image-checkbox.is-invalid .invalid-feedback {
  display: block;
}


</style>


<script type="text/javascript">


</script>
